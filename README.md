# Cyrillic (Russian) text recognition

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –¥–µ—Å–∫—Ç–æ–ø-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –±–∞–∑–µ TensorFlow/Keras, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ä—É–∫–æ–ø–∏—Å–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ —Ñ—Ä–∞–∑—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ `tkinter`: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥, –ø—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –∏—Ç–æ–≥–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—ã –≤—ã–≤–æ–¥—è—Ç—Å—è –ø—Ä—è–º–æ –≤ –æ–∫–Ω–µ.

![demo](images/Example.png)

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –∑–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫ (PNG/JPG/JPEG/BMP/GIF);
- –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞;
- –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –±–µ–∑ –ø–æ–¥–≤–∏—Å–∞–Ω–∏–π UI;
- –¥–µ—Ç–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º –∏ —Ü–≤–µ—Ç–æ–≤—ã–º –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º;
- —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –∏–º–µ–Ω–∞–º–∏ —Ñ–∞–π–ª–æ–≤;
- –∫–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.9+ (–ø—Ä–æ–µ–∫—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ Windows 10);
- `tkinter` (–∏–¥—ë—Ç –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ —Å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–æ–≤ Python);
- –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `requirements.txt`:
  - `tensorflow>=2.5.0`
  - `numpy>=1.21.0`
  - `pandas`
  - `scikit-learn`

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
git clone https://github.com/<username>/software-russian-handwritten-text.git
cd software-russian-handwritten-text
python -m venv venv
venv\Scripts\activate        # Windows
python -m pip install --upgrade pip
pip install -r requirements.txt
```

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏
1. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª –≤–µ—Å–æ–≤ `model.h5`.
2. –ü–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ —Ä—è–¥–æ–º —Å `predict.py`.
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å –≤ `load_model_weights(...)`.

## –ó–∞–ø—É—Å–∫
```bash
python predict.py
```
> –ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –Ω–∞ CPU, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ `cudart64_110.dll not found` –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å ‚Äî TensorFlow –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä.

## –†–∞–±–æ—Ç–∞ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
1. –ù–∞–∂–º–∏—Ç–µ **¬´üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è¬ª** –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã (–¥–æ—Å—Ç—É–ø–µ–Ω –º—É–ª—å—Ç–∏–≤—ã–±–æ—Ä).
2. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è ¬´‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!¬ª.
3. –ù–∞–∂–º–∏—Ç–µ **¬´üîç –†–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ç–µ–∫—Å—Ç¬ª** ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∏–¥—ë—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ, —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –≤ –Ω–∏–∂–Ω–µ–º –±–ª–æ–∫–µ: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–º—è —Ñ–∞–π–ª–∞ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞.
5. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞–∂–º–∏—Ç–µ **¬´üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å¬ª**, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏ –æ—á–∏—Å—Ç–∏—Ç—å –≤—ã–≤–æ–¥.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏
- –≠–∫—Å—Ç—Ä–∞–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: VGG16 (—Å–ª–æ–∏ `block1` –∏ `block2`, –±–µ–∑ –≤–µ—Ä—Ö—É—à–∫–∏).
- –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞: —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π + `BatchNorm`.
- –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —á–∞—Å—Ç—å: –¥–≤–∞ BiLSTM-—Å–ª–æ—è (256 –∏ 128 –Ω–µ–π—Ä–æ–Ω–æ–≤).
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä: –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π –Ω–∞ 151 –∫–ª–∞—Å—Å —Å softmax.
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: CTC (`CTCLayer`).
- –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è: CER 0.0194, CTC loss 1.6510 (–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏).

## –î–∞—Ç–∞—Å–µ—Ç
–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –æ–ª–∏–º–ø–∏–∞–¥—ã –ø–æ –ò–ò –∏ —Ö–∞–∫–∞—Ç–æ–Ω–∞ –ø–æ OCR, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ê–∫–∞–¥–µ–º–∏–µ–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞. –î–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä—É–∫–æ–ø–∏—Å–Ω—ã–µ —Å–ª–æ–≤–∞ –∏ —Å–∏–º–≤–æ–ª—ã –∫–∏—Ä–∏–ª–ª–∏—Ü—ã/–ª–∞—Ç–∏–Ω–∏—Ü—ã, —Ü–∏—Ñ—Ä—ã –∏ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã.

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–∏–º–≤–æ–ª—ã
`!, ", %, (, ), *, +, ,, -, ., /, 0-9, :, ;, <, =, >, ?, A-Z, [, ], _, a-z, |, }, –Å, –ê-–Ø, –∞-—è, —ä, —ã, —å, —ç, —é, —è, —ë, ‚Ññ`  
(—Å–º. —Å–ø–∏—Å–æ–∫ `vocab_list` –≤ `predict.py` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ—á–Ω—è).

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- `predict.py` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π GUI –∏ –∫–æ–¥ –º–æ–¥–µ–ª–∏.
- `model.h5` ‚Äî –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ (–Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –¥–æ–±–∞–≤—å—Ç–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ).
- `images/` ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
- `train_model.ipynb` ‚Äî —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø–æ –æ–±—É—á–µ–Ω–∏—é.

PR –∏ issues –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è ü§ù
